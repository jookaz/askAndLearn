{"version":3,"file":"js/505.4718b59e.js","mappings":"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","sources":["webpack://teacher-ai/./src/api/admin.js","webpack://teacher-ai/./src/views/PromptManageView.vue","webpack://teacher-ai/./src/views/PromptManageView.vue?2c75"],"sourcesContent":["import request from '@/utils/request'\r\n\r\nexport const getModelPage = (params) => {\r\n  return request({\r\n    url: '/admin/model',\r\n    method: 'get',\r\n    params\r\n  })\r\n}\r\n\r\nexport const deleteModels = (ids) =>\r\n  request.delete('/admin/model', {\r\n    params: { ids },\r\n    paramsSerializer: {\r\n      indexes: null // 禁用数组索引格式\r\n    }\r\n  })\r\n\r\nexport const createModel = (data) => {\r\n  return request({\r\n    url: '/admin/model',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n\r\nexport const updateModel = (data) => {\r\n  return request({\r\n    url: '/admin/model',\r\n    method: 'put',\r\n    data\r\n  })\r\n}\r\n\r\nexport const getModelDetail = (id) => {\r\n  return request({\r\n    url: `/admin/model/${id}`,\r\n    method: 'get'\r\n  })\r\n}\r\nexport const setSystemModel = (modelId) => {\r\n  return request({\r\n    url: `/admin/model/setSystemModel`,\r\n    method: 'put',\r\n    params: { modelId }\r\n  })\r\n}\r\n\r\nexport const getPromptPage = (params) =>\r\n  request.get('/admin/prompt-template/page', { params })\r\n\r\nexport const addPrompt = (data) =>\r\n  request.post('/admin/prompt-template', data)\r\n\r\nexport const updatePrompt = (data) =>\r\n  request.put('/admin/prompt-template', data)\r\n\r\nexport const deletePrompts = (ids) =>\r\n  request.delete('/admin/prompt-template', {\r\n    params: { ids },\r\n    paramsSerializer: { indexes: null }\r\n  })\r\n\r\nexport const getPromptDetail = (id) =>\r\n  request.get(`/admin/prompt-template/${id}`)","<template>\r\n  <el-card class=\"box-card\">\r\n    <!-- 搜索和新增区域 -->\r\n    <div class=\"mb-4\">\r\n      <el-button type=\"primary\" @click=\"handleCreate\">新增提示词</el-button>\r\n    </div>\r\n\r\n    <!-- 数据表格 -->\r\n    <el-table\r\n      v-loading=\"loading\"\r\n      :data=\"tableData.list\"\r\n      style=\"width: 100%\"\r\n    >\r\n      <el-table-column prop=\"id\" label=\"ID\" width=\"80\" />\r\n      <el-table-column prop=\"promptName\" label=\"名称\" />\r\n      <el-table-column label=\"内容预览\" width=\"300\">\r\n        <template #default=\"{ row }\">\r\n          <el-link type=\"primary\" @click=\"showDetail(row)\">\r\n            {{ truncate(row.promptContent, 100) }}\r\n          </el-link>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" width=\"150\">\r\n        <template #default=\"{ row }\">\r\n          <el-button size=\"small\" @click=\"handleEdit(row)\">编辑</el-button>\r\n          <el-button\r\n            size=\"small\"\r\n            type=\"danger\"\r\n            @click=\"handleDelete([row.id])\"\r\n          >\r\n            删除\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 分页组件 -->\r\n    <el-pagination\r\n      class=\"mt-4\"\r\n      v-model:current-page=\"pageNo\"\r\n      v-model:page-size=\"pageSize\"\r\n      :total=\"tableData.total\"\r\n      @current-change=\"fetchData\"\r\n    />\r\n\r\n    <!-- 详情弹窗 -->\r\n    <el-dialog\r\n      v-model=\"detailVisible\"\r\n      :title=\"currentRow.promptName\"\r\n      width=\"60%\"\r\n    >\r\n      <el-input\r\n        v-model=\"currentRow.promptContent\"\r\n        type=\"textarea\"\r\n        :autosize=\"{ minRows: 10, maxRows: 20 }\"\r\n        readonly\r\n        class=\"detail-textarea\"\r\n      />\r\n    </el-dialog>\r\n\r\n    <!-- 编辑/新增弹窗 -->\r\n    <el-dialog\r\n      v-model=\"formVisible\"\r\n      :title=\"isEdit ? '编辑提示词' : '新增提示词'\"\r\n    >\r\n      <el-form :model=\"formData\" label-width=\"80px\">\r\n        <el-form-item label=\"名称\" required>\r\n          <el-input v-model=\"formData.promptName\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"内容\" required>\r\n          <el-input\r\n            v-model=\"formData.promptContent\"\r\n            type=\"textarea\"\r\n            :rows=\"8\"\r\n          />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <el-button @click=\"formVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"submitForm\">确认</el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </el-card>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive } from 'vue'\r\nimport {\r\n  getPromptPage,\r\n  addPrompt,\r\n  updatePrompt,\r\n  deletePrompts,\r\n  getPromptDetail\r\n} from '@/api/admin'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\n\r\n// 分页数据\r\nconst pageNo = ref(1)\r\nconst pageSize = ref(10)\r\nconst loading = ref(false)\r\nconst tableData = reactive({ list: [], total: 0 })\r\n\r\n// 详情弹窗控制\r\nconst detailVisible = ref(false)\r\nconst currentRow = reactive({\r\n  promptName: '',\r\n  promptContent: ''\r\n})\r\n\r\n// 表单控制\r\nconst formVisible = ref(false)\r\nconst isEdit = ref(false)\r\nconst formData = reactive({\r\n  id: null,\r\n  promptName: '',\r\n  promptContent: ''\r\n})\r\n\r\n// 文本截断方法\r\nconst truncate = (text, length) => {\r\n  if (!text) return ''\r\n  return text.length > length ? text.slice(0, length) + '...' : text\r\n}\r\n\r\n// 获取数据\r\nconst fetchData = async () => {\r\n  try {\r\n    loading.value = true\r\n    const res = await getPromptPage({\r\n      pageNum: pageNo.value,\r\n      pageSize: pageSize.value\r\n    })\r\n    console.log('Fetched data:', res.data)  // 打印返回的数据\r\n    if (res.data.code === 1) {\r\n      console.log('Fetched data111:', res.data)  // 打印返回的数据\r\n      tableData.list = res.data.data.records  // 修改这里\r\n      tableData.total = res.data.data.total\r\n    }\r\n  } catch (e) {\r\n    ElMessage.error('数据加载失败')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 显示详情\r\nconst showDetail = (row) => {\r\n  currentRow.promptName = row.promptName\r\n  currentRow.promptContent = row.promptContent\r\n  detailVisible.value = true\r\n}\r\n\r\n// 删除操作\r\nconst handleDelete = async (ids) => {\r\n  try {\r\n    await ElMessageBox.confirm(`确认删除选中的${ids.length}条记录？`)\r\n    const res = await deletePrompts(ids)\r\n    if (res.data.code === 1) { // 添加.data层级\r\n      ElMessage.success('删除成功')\r\n      pageNo.value = 1 // 重置分页\r\n      fetchData()\r\n    }\r\n  } catch (e) {\r\n    /* 取消删除不处理 */\r\n  }\r\n}\r\n\r\n// 初始化加载\r\nfetchData()\r\n\r\n// 在setup()中添加以下方法\r\nconst handleCreate = () => {\r\n  formData.value = {\r\n    id: null,\r\n    promptName: '',\r\n    promptContent: ''\r\n  }\r\n  isEdit.value = false\r\n  formVisible.value = true\r\n}\r\n\r\nconst handleEdit = async (row) => {\r\n  try {\r\n    const res = await getPromptDetail(row.id)\r\n    if (res.data.code === 1) { // 添加.data层级\r\n      Object.assign(formData, {\r\n        id: row.id,\r\n        promptName: res.data.data.promptName,\r\n        promptContent: res.data.data.promptContent\r\n      })\r\n      isEdit.value = true\r\n      formVisible.value = true\r\n    }\r\n  } catch (e) {\r\n    ElMessage.error('获取详情失败')\r\n  }\r\n}\r\n\r\nconst submitForm = async () => {\r\n  try {\r\n    const payload = {\r\n      promptName: formData.promptName,\r\n      promptContent: formData.promptContent\r\n    }\r\n    \r\n    let res\r\n    if (isEdit.value) {\r\n      res = await updatePrompt({ ...payload, id: formData.id })\r\n    } else {\r\n      res = await addPrompt(payload)\r\n    }\r\n    \r\n    if (res.data.code === 1) {\r\n      ElMessage.success(isEdit.value ? '更新成功' : '新增成功')\r\n      formVisible.value = false // 确保关闭弹窗\r\n      fetchData()\r\n      Object.assign(formData, { id: null, promptName: '', promptContent: '' })\r\n    }\r\n  } catch (error) {\r\n    ElMessage.error('操作失败：' + (error.message || '未知错误'))\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.detail-textarea {\r\n  font-family: monospace;\r\n  line-height: 1.5;\r\n}\r\n</style>\r\n","import script from \"./PromptManageView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PromptManageView.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./PromptManageView.vue?vue&type=style&index=0&id=3b78b2b5&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3b78b2b5\"]])\n\nexport default __exports__"],"names":["getModelPage","params","request","url","method","deleteModels","ids","delete","paramsSerializer","indexes","createModel","data","updateModel","getModelDetail","id","setSystemModel","modelId","getPromptPage","get","addPrompt","post","updatePrompt","put","deletePrompts","getPromptDetail","pageNo","ref","pageSize","loading","tableData","reactive","list","total","detailVisible","currentRow","promptName","promptContent","formVisible","isEdit","formData","truncate","text","length","slice","fetchData","async","value","res","pageNum","console","log","code","records","e","ElMessage","error","showDetail","row","handleDelete","ElMessageBox","confirm","success","handleCreate","handleEdit","Object","assign","submitForm","payload","message","__exports__"],"sourceRoot":""}