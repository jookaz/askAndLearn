"use strict";(self["webpackChunkteacher_ai"]=self["webpackChunkteacher_ai"]||[]).push([[402],{2402:function(e,a,s){s.r(a),s.d(a,{default:function(){return w}});s(4114);var t=s(6768),r=s(4232),l=s(144),n=s(5130),u=s(1219),o=s(1387),c=s(357),i=s(1109),d=s(6526),p=s(6377);const m={class:"improve-container"},v={class:"header-content"},h={style:{color:"#409EFF"}},k={class:"chat-container"},g={class:"user-message"},b={class:"content-box"},I={class:"message-content"},y={class:"ai-response"},f=["innerHTML"],_={key:0,class:"input-area"},F={key:1,class:"completion-tip"};var L={__name:"ImproveAnswerView",setup(e){const a=(0,o.lq)(),s=(0,l.Kh)([]),L=(0,l.KR)(""),q=(0,l.KR)(!1),C=(0,l.KR)(!0),w=(0,l.KR)(null);c.xI.setOptions({highlight:e=>i.A.highlightAuto(e).value,breaks:!0});const K=e=>e?(0,c.xI)(e):"",R=async()=>{if(L.value.trim())try{q.value=!0;const e=L.value;L.value="",s.push({content:e,response:"思考中..."}),await(0,t.dY)(),N();const r=await(0,d.T$)({prompt:e,userId:Number(localStorage.getItem("student-id")),courseId:Number(a.params.courseId),chapterId:Number(a.params.chapterId),question:a.query.question,questionId:Number(a.query.questionId)});if(1===r.data?.code){const e=r.data.data||{},t=e.response||"";s[s.length-1].response=t,!0===e.flag&&(C.value=!1,(0,p.X)({userId:Number(localStorage.getItem("student-id")),courseId:Number(a.params.courseId),chapterId:Number(a.params.chapterId),step:3}))}}catch(e){u.nk.error("提交失败："+e.message)}finally{q.value=!1,N()}},N=()=>{w.value&&(w.value.scrollTop=w.value.scrollHeight)};return(e,u)=>{const o=(0,t.g2)("el-card"),c=(0,t.g2)("User"),i=(0,t.g2)("el-icon"),d=(0,t.g2)("el-input"),p=(0,t.g2)("el-button"),N=(0,t.g2)("el-result");return(0,t.uX)(),(0,t.CE)("div",m,[(0,t.bF)(o,{class:"question-header"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",v,[(0,t.Lk)("h3",h,"📝 问题："+(0,r.v_)((0,l.R1)(a).query.question),1)])])),_:1}),(0,t.Lk)("div",k,[(0,t.Lk)("div",{ref_key:"messageBox",ref:w,class:"message-list"},[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s,((e,a)=>((0,t.uX)(),(0,t.CE)("div",{key:a,class:"message-item"},[(0,t.Lk)("div",g,[(0,t.bF)(i,{class:"avatar"},{default:(0,t.k6)((()=>[(0,t.bF)(c)])),_:1}),(0,t.Lk)("div",b,[(0,t.Lk)("div",I,(0,r.v_)(e.content),1)])]),(0,t.Lk)("div",y,[(0,t.bF)(o,{class:"response-card"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",{class:"response-content",innerHTML:K(e.response)},null,8,f)])),_:2},1024)])])))),128))],512),C.value?((0,t.uX)(),(0,t.CE)("div",_,[(0,t.bF)(d,{modelValue:L.value,"onUpdate:modelValue":u[0]||(u[0]=e=>L.value=e),type:"textarea",rows:4,placeholder:"请输入您的见解",disabled:q.value,onKeyup:(0,n.jR)((0,n.D$)(R,["prevent"]),["enter"])},null,8,["modelValue","disabled","onKeyup"]),(0,t.bF)(p,{type:"primary",class:"submit-btn",loading:q.value,onClick:R},{default:(0,t.k6)((()=>u[2]||(u[2]=[(0,t.eW)(" 提交 ")]))),_:1},8,["loading"])])):((0,t.uX)(),(0,t.CE)("div",F,[(0,t.bF)(N,{icon:"success",title:"恭喜完成本章节学习！"},{extra:(0,t.k6)((()=>[(0,t.bF)(p,{type:"primary",onClick:u[1]||(u[1]=s=>e.$router.push({name:"AnswerSomeone",params:{courseId:(0,l.R1)(a).params.courseId,chapterId:(0,l.R1)(a).params.chapterId}}))},{default:(0,t.k6)((()=>u[3]||(u[3]=[(0,t.eW)("查看他人问题")]))),_:1})])),_:1})]))])])}}},q=s(1241);const C=(0,q.A)(L,[["__scopeId","data-v-208049fc"]]);var w=C}}]);
//# sourceMappingURL=402.90a59837.js.map