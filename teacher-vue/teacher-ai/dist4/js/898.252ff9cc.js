"use strict";(self["webpackChunkteacher_ai"]=self["webpackChunkteacher_ai"]||[]).push([[898],{8898:function(e,a,s){s.r(a),s.d(a,{default:function(){return x}});s(4114),s(8111),s(116);var t=s(6768),l=s(4232),u=s(5130),r=s(144),n=s(7477),c=s(1387),o=s(6377),d=s(2933),i=s(1219),p=s(357),m=s(1109),v=s(6526);const k={class:"ask-container"},g={class:"user-message"},b={class:"content-box"},f={class:"message-content"},h=["innerHTML"],I={key:1,class:"input-area"},_={class:"input-wrapper"},y={key:2,class:"multi-model-area"},F={class:"tip-text"};var w={__name:"AskView",setup(e){const a=(0,c.rd)(),s=(0,c.lq)(),w=(0,r.KR)(""),L=(0,r.Kh)([]),q=(0,r.KR)(!1),x=(0,r.KR)(!1),C=(0,r.KR)(null),N=()=>{C.value&&(C.value.scrollTop=C.value.scrollHeight)},R=async()=>{if(!K.value)return;if(!w.value.trim())return;const e=w.value,a=Date.now();L.push({id:a,content:e,response:"æ€è€ƒä¸­..."}),await(0,t.dY)(),N(),w.value="",q.value=!0;try{const l=await(0,v.h2)({prompt:e,userId:Number(localStorage.getItem("student-id")),courseId:Number(s.params.courseId),chapterId:Number(s.params.chapterId)},{timeout:3e5});if(1===l.data?.code){const e=L.find((e=>e.id===a));if(e){const a=l.data.data||{};e.response=a.response||"",e.flag=a.flag,e.question=a.question,e.questionId=a.questionId,x.value=e.flag,await(0,t.dY)(),N(),e.flag&&(0,o.X)({userId:Number(localStorage.getItem("student-id")),courseId:Number(s.params.courseId),chapterId:Number(s.params.chapterId),step:Number(1)})}else d.s.confirm("å¤§æ¨¡å‹æœåŠ¡è¿æ¥å¼‚å¸¸ï¼Œé”™è¯¯ä¿¡æ¯: "+(l.data?.message||"æœªçŸ¥é”™è¯¯")+"ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•","æœåŠ¡ä¸å¯ç”¨",{confirmButtonText:"ç«‹å³åˆ·æ–°",cancelButtonText:"å–æ¶ˆ",type:"error"}).then((()=>{location.reload()}))}}catch(l){i.nk.error("è¯·æ±‚å¤±è´¥: "+l.message)}finally{q.value=!1}},K=(0,t.EW)((()=>!q.value));p.xI.setOptions({highlight:e=>m.A.highlightAuto(e).value,breaks:!0});const X=e=>(0,p.xI)(e||""),E=()=>{const e=L[L.length-1];a.push({name:"chapter-detail",params:{courseId:s.params.courseId,chapterId:s.params.chapterId},query:{question:e.question,userId:Number(localStorage.getItem("student-id")),questionId:e.questionId}})};return(e,a)=>{const s=(0,t.g2)("el-card"),c=(0,t.g2)("User"),o=(0,t.g2)("el-icon"),d=(0,t.g2)("el-input"),i=(0,t.g2)("el-button");return(0,t.uX)(),(0,t.CE)("div",k,[0===L.length?((0,t.uX)(),(0,t.Wv)(s,{key:0,class:"welcome-card"},{default:(0,t.k6)((()=>a[1]||(a[1]=[(0,t.Lk)("div",{class:"welcome-text"},"ğŸ‰ æ¬¢è¿è¿›å…¥æœ¬ç« èŠ‚çš„å­¦ä¹ ï¼ï¼ï¼",-1),(0,t.Lk)("div",{class:"tip-text"},"è¯·åœ¨ä¸‹æ–¹çš„è¾“å…¥æ¡†ä¸­æå‡ºæ‚¨çš„é—®é¢˜ï¼Œæˆ‘å°†ä¸ºæ‚¨æä¾›ä¸“ä¸šçš„è§£ç­”",-1)]))),_:1})):(0,t.Q3)("",!0),(0,t.Lk)("div",{ref_key:"messageBox",ref:C,class:"message-list"},[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(L,((e,a)=>((0,t.uX)(),(0,t.CE)("div",{key:a,class:"message-item"},[(0,t.Lk)("div",g,[(0,t.bF)(o,{class:"avatar"},{default:(0,t.k6)((()=>[(0,t.bF)(c)])),_:1}),(0,t.Lk)("div",b,[(0,t.Lk)("div",f,(0,l.v_)(e.content),1)])]),(0,t.bF)(s,{class:"ai-response"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",{class:"response-content",innerHTML:X(e.response)},null,8,h)])),_:2},1024)])))),128))],512),x.value?((0,t.uX)(),(0,t.CE)("div",y,[(0,t.bF)(i,{type:"success",class:"multi-btn",onClick:E},{default:(0,t.k6)((()=>[(0,t.bF)(o,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,r.R1)(n.gf4))])),_:1}),a[3]||(a[3]=(0,t.eW)(" å¤šæ¨¡å‹æ·±åº¦è§£æ "))])),_:1}),(0,t.Lk)("div",F,[(0,t.bF)(o,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,r.R1)(n.N_H))])),_:1}),a[4]||(a[4]=(0,t.eW)(" å·²ä¸ºæ‚¨åŒ¹é…æœ€ä½³è§£ç­”æ–¹æ¡ˆï¼Œç‚¹å‡»æŒ‰é’®æŸ¥çœ‹å¤šæ¨¡å‹å¯¹æ¯”åˆ†æ "))])])):((0,t.uX)(),(0,t.CE)("div",I,[(0,t.Lk)("div",_,[(0,t.bF)(d,{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value=e),type:"textarea",rows:3,placeholder:"è¯·è¾“å…¥æ‚¨çš„é—®é¢˜...",resize:"none",onKeyup:(0,u.jR)(R,["enter"])},null,8,["modelValue"]),(0,t.bF)(i,{type:"primary",disabled:!K.value,class:"send-btn",onClick:R},{default:(0,t.k6)((()=>[(0,t.bF)(o,{class:"send-icon"},{default:(0,t.k6)((()=>[(0,t.bF)((0,r.R1)(n.Yk4))])),_:1}),a[2]||(a[2]=(0,t.eW)(" å‘é€æé—® "))])),_:1},8,["disabled"])])]))])}}},L=s(1241);const q=(0,L.A)(w,[["__scopeId","data-v-109fec6a"]]);var x=q}}]);
//# sourceMappingURL=898.252ff9cc.js.map